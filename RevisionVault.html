<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RevisionVault - University Study Materials</title>
    <link rel="icon" type="image/x-icon" href="https://cdn-icons-png.flaticon.com/512/2237/2237289.png">
    <style>
        /* === MODERN CSS RESET === */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #f72585;
            --success: #4cc9f0;
            --dark: #2b2d42;
            --light: #f8f9fa;
            --gray: #6c757d;
            --shadow: 0 10px 30px rgba(0,0,0,0.1);
            --gradient: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%);
            --radius: 12px;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: var(--dark);
            line-height: 1.6;
        }
        
        /* === MAIN CONTAINER === */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* === HEADER === */
        .header {
            background: white;
            border-radius: var(--radius);
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-icon {
            background: var(--gradient);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }
        
        .logo-text h1 {
            font-size: 28px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
        }
        
        .tagline {
            color: var(--gray);
            font-size: 14px;
        }
        
        /* === HERO SECTION === */
        .hero {
            background: var(--gradient);
            color: white;
            border-radius: var(--radius);
            padding: 50px 30px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }
        
        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 200%;
            background: rgba(255,255,255,0.1);
            transform: rotate(30deg);
        }
        
        .hero h2 {
            font-size: 36px;
            margin-bottom: 15px;
            font-weight: 700;
        }
        
        .hero p {
            font-size: 18px;
            opacity: 0.9;
            margin-bottom: 25px;
        }
        
        .price-badge {
            background: rgba(255,255,255,0.2);
            display: inline-flex;
            align-items: center;
            padding: 15px 30px;
            border-radius: 50px;
            backdrop-filter: blur(10px);
            margin: 20px 0;
        }
        
        .price {
            font-size: 48px;
            font-weight: 800;
            margin-right: 10px;
        }
        
        .period {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .per-day {
            background: rgba(255,255,255,0.3);
            padding: 8px 20px;
            border-radius: 30px;
            font-size: 14px;
            display: inline-block;
        }
        
        /* === STEPS SECTION === */
        .steps-section {
            background: white;
            border-radius: var(--radius);
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }
        
        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 30px;
            color: var(--secondary);
            font-size: 24px;
        }
        
        .section-title i {
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .steps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .step-card {
            background: var(--light);
            padding: 25px;
            border-radius: var(--radius);
            border-left: 4px solid var(--primary);
            transition: transform 0.3s;
        }
        
        .step-card:hover {
            transform: translateY(-5px);
        }
        
        .step-number {
            background: var(--gradient);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        /* === PAYMENT BOX === */
        .payment-box {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 30px;
            border-radius: var(--radius);
            text-align: center;
            margin: 30px 0;
        }
        
        .payment-label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .mpesa-number {
            font-size: 32px;
            font-weight: 800;
            letter-spacing: 2px;
            margin: 10px 0;
            font-family: monospace;
        }
        
        .payment-note {
            font-size: 13px;
            opacity: 0.9;
            margin-top: 10px;
        }
        
        /* === CONTACT LINKS === */
        .contact-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .contact-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 25px;
            background: white;
            border-radius: 50px;
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .contact-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .contact-btn.telegram {
            background: linear-gradient(135deg, #0088cc 0%, #006699 100%);
            color: white;
        }
        
        .contact-btn.whatsapp {
            background: linear-gradient(135deg, #25d366 0%, #128c7e 100%);
            color: white;
        }
        
        /* === FORM SECTION === */
        .form-section {
            background: white;
            border-radius: var(--radius);
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .form-input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e2e8f0;
            border-radius: var(--radius);
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
        }
        
        .btn {
            padding: 16px 32px;
            border: none;
            border-radius: var(--radius);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
        }
        
        .btn-primary {
            background: var(--gradient);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(67, 97, 238, 0.3);
        }
        
        .btn-secondary {
            background: #e2e8f0;
            color: var(--dark);
            margin-top: 15px;
        }
        
        .btn-secondary:hover {
            background: #cbd5e1;
        }
        
        /* === DOCUMENTS SECTION === */
        .documents-section {
            background: white;
            border-radius: var(--radius);
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }
        
        .documents-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .search-box {
            flex: 1;
            min-width: 300px;
            position: relative;
        }
        
        .search-input {
            width: 100%;
            padding: 15px 20px 15px 45px;
            border: 2px solid #e2e8f0;
            border-radius: var(--radius);
            font-size: 16px;
        }
        
        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }
        
        .documents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        
        .document-card {
            background: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            transition: all 0.3s;
            border: 1px solid #e2e8f0;
        }
        
        .document-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }
        
        .doc-icon {
            background: var(--gradient);
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 32px;
        }
        
        .doc-content {
            padding: 25px;
        }
        
        .doc-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--dark);
        }
        
        .doc-meta {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            font-size: 14px;
            color: var(--gray);
        }
        
        .meta-tag {
            background: #e2e8f0;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
        }
        
        .download-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: var(--gradient);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 500;
            margin-top: 15px;
            transition: all 0.3s;
        }
        
        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(67, 97, 238, 0.3);
        }
        
        .locked {
            background: #e2e8f0;
            color: var(--gray);
        }
        
        /* === STATUS MESSAGES === */
        .status {
            padding: 20px;
            border-radius: var(--radius);
            margin: 20px 0;
            display: none;
        }
        
        .status.success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
        }
        
        .status.error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
        }
        
        /* === USER PANEL === */
        .user-panel {
            background: white;
            border-radius: var(--radius);
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            display: none;
        }
        
        .user-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .user-avatar {
            width: 60px;
            height: 60px;
            background: var(--gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }
        
        .user-info {
            flex: 1;
        }
        
        .user-name {
            font-weight: 700;
            font-size: 20px;
        }
        
        .user-subscription {
            color: var(--success);
            font-weight: 500;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: var(--light);
            padding: 20px;
            border-radius: var(--radius);
            text-align: center;
        }
        
        .stat-value {
            font-size: 36px;
            font-weight: 800;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-label {
            color: var(--gray);
            font-size: 14px;
        }
        
        /* === FOOTER === */
        .footer {
            background: white;
            border-radius: var(--radius);
            padding: 40px;
            margin-top: 40px;
            box-shadow: var(--shadow);
            text-align: center;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .footer-link {
            color: var(--gray);
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .footer-link:hover {
            color: var(--primary);
        }
        
        .copyright {
            color: var(--gray);
            font-size: 14px;
            margin-top: 20px;
        }
        
        /* === RESPONSIVE DESIGN === */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }
            
            .hero h2 {
                font-size: 28px;
            }
            
            .price {
                font-size: 36px;
            }
            
            .mpesa-number {
                font-size: 24px;
            }
            
            .documents-grid {
                grid-template-columns: 1fr;
            }
            
            .contact-links {
                flex-direction: column;
            }
            
            .contact-btn {
                justify-content: center;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* === ANIMATIONS === */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        /* === LOADING SPINNER === */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e2e8f0;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* === BADGES === */
        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .badge-success {
            background: #d1fae5;
            color: #065f46;
        }
        
        .badge-warning {
            background: #fef3c7;
            color: #92400e;
        }
        
        .badge-danger {
            background: #fee2e2;
            color: #991b1b;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container fade-in">
        <!-- HEADER -->
        <header class="header">
            <div class="logo-section">
                <div class="logo-icon">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <div class="logo-text">
                    <h1>RevisionVault</h1>
                    <p class="tagline">Premium University Study Materials</p>
                </div>
            </div>
            <div class="user-status" id="userStatus">
                <!-- Will be filled by JavaScript -->
            </div>
        </header>

        <!-- HERO SECTION -->
        <section class="hero">
            <h2>Access 1000+ University Revision Papers</h2>
            <p>One subscription. All subjects. Unlimited downloads.</p>
            <div class="price-badge">
                <span class="price">Ksh 50</span>
                <span class="period">/semester</span>
            </div>
            <div class="per-day">Less than <strong>Ksh 0.50/day</strong></div>
        </section>

        <!-- STATUS MESSAGE -->
        <div id="statusMessage" class="status" style="display: none;"></div>

        <!-- USER PANEL (Hidden by default) -->
        <div class="user-panel" id="userPanel">
            <div class="user-header">
                <div class="user-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="user-info">
                    <div class="user-name" id="userName">Loading...</div>
                    <div class="user-subscription">
                        <i class="fas fa-crown"></i> <span id="userPlan">Premium Subscription</span>
                    </div>
                </div>
                <button class="btn btn-secondary" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="daysLeft">180</div>
                    <div class="stat-label">Days Remaining</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="documentsCount">1,247</div>
                    <div class="stat-label">Documents Available</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="expiryDate">20/07/2024</div>
                    <div class="stat-label">Expiry Date</div>
                </div>
            </div>
        </div>

        <!-- HOW TO SUBSCRIBE -->
        <section class="steps-section">
            <h2 class="section-title"><i class="fas fa-mobile-alt"></i> How to Subscribe</h2>
            
            <div class="steps-grid">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <h3>Open M-Pesa</h3>
                    <p>Go to your M-Pesa menu or use the M-Pesa app</p>
                </div>
                
                <div class="step-card">
                    <div class="step-number">2</div>
                    <h3>Send Money</h3>
                    <p>Select <strong>"Send Money"</strong> from the menu</p>
                </div>
                
                <div class="step-card">
                    <div class="step-number">3</div>
                    <h3>Enter Details</h3>
                    <p>Send <strong>Ksh 50</strong> to the number below</p>
                </div>
            </div>

            <!-- PAYMENT BOX -->
            <div class="payment-box">
                <div class="payment-label">Send Ksh 50 to:</div>
                <div class="mpesa-number" id="mpesaDisplay">0765098865</div>
                <div class="payment-label">Reference: <strong>REVISION</strong></div>
                <div class="payment-note">(Works with M-Pesa & Equitel)</div>
            </div>

            <div class="steps-grid">
                <div class="step-card">
                    <div class="step-number">4</div>
                    <h3>Enter PIN</h3>
                    <p>Complete the transaction with your PIN</p>
                </div>
                
                <div class="step-card">
                    <div class="step-number">5</div>
                    <h3>Get Code</h3>
                    <p>Copy the <strong>Transaction Code</strong> from SMS</p>
                </div>
                
                <div class="step-card">
                    <div class="step-number">6</div>
                    <h3>Verify Below</h3>
                    <p>Enter details below to activate access</p>
                </div>
            </div>

            <!-- CONTACT LINKS -->
            <div class="contact-links">
                <a href="https://t.me/+QlZ_LCrZoB5kZjNk" class="contact-btn telegram" target="_blank">
                    <i class="fab fa-telegram"></i>
                    Join Telegram Channel
                </a>
                <a href="#" id="whatsappLink" class="contact-btn whatsapp">
                    <i class="fab fa-whatsapp"></i>
                    Contact on WhatsApp
                </a>
            </div>
        </section>

        <!-- VERIFICATION FORM -->
        <section class="form-section">
            <h2 class="section-title"><i class="fas fa-check-circle"></i> Verify Your Payment</h2>
            
            <div class="form-group">
                <label class="form-label" for="userPhone">Your Phone Number</label>
                <input type="tel" id="userPhone" class="form-input" placeholder="0765 098 865" maxlength="13">
                <small style="color: var(--gray); margin-top: 5px; display: block;">Enter the number you used for payment</small>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="txnCode">Transaction Code</label>
                <input type="text" id="txnCode" class="form-input" placeholder="ABC123XYZ" maxlength="10">
                <small style="color: var(--gray); margin-top: 5px; display: block;">From M-Pesa confirmation SMS</small>
            </div>
            
            <button class="btn btn-primary" onclick="verifyPayment()">
                <i class="fas fa-paper-plane"></i> Submit for Verification
            </button>
            
            <button class="btn btn-secondary" onclick="testPayment()">
                <i class="fas fa-bolt"></i> Try Demo (No Payment Needed)
            </button>
            
            <p style="text-align: center; margin-top: 20px; color: var(--gray);">
                <i class="fas fa-clock"></i> Access activated within 5-10 minutes
            </p>
        </section>

        <!-- DOCUMENTS SECTION -->
        <section class="documents-section">
            <div class="documents-header">
                <h2 class="section-title"><i class="fas fa-file-pdf"></i> Available Documents</h2>
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" class="search-input" placeholder="Search by course, university, or year...">
                </div>
            </div>
            
            <div id="documentsList">
                <!-- Documents will load here -->
                <div class="spinner"></div>
                <p style="text-align: center; margin-top: 10px; color: var(--gray);">Loading documents...</p>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-secondary" onclick="requestNotes()">
                    <i class="fas fa-comment"></i> Request Specific Notes
                </button>
                <p style="margin-top: 15px; color: var(--gray); font-size: 14px;">
                    <i class="fas fa-info-circle"></i> All documents stored on Telegram for fast downloads
                </p>
            </div>
        </section>

        <!-- FOOTER -->
        <footer class="footer">
            <div class="logo-section" style="justify-content: center; margin-bottom: 20px;">
                <div class="logo-icon" style="width: 50px; height: 50px;">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <div class="logo-text">
                    <h1 style="font-size: 24px;">RevisionVault</h1>
                </div>
            </div>
            
            <p>University study materials made affordable and accessible</p>
            
            <div class="footer-links">
                <a href="https://t.me/+QlZ_LCrZoB5kZjNk" class="footer-link" target="_blank">
                    <i class="fab fa-telegram"></i> Telegram
                </a>
                <a href="#" id="footerWhatsapp" class="footer-link">
                    <i class="fab fa-whatsapp"></i> WhatsApp
                </a>
                <a href="mailto:support@revisionvault.com" class="footer-link">
                    <i class="fas fa-envelope"></i> Email
                </a>
            </div>
            
            <div style="margin: 30px 0; padding: 20px; background: var(--light); border-radius: var(--radius);">
                <h3 style="margin-bottom: 10px; color: var(--dark);">Need Help?</h3>
                <p style="color: var(--gray); margin-bottom: 15px;">Contact us for support or document requests</p>
                <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap;">
                    <div style="text-align: center;">
                        <div style="font-weight: 600; color: var(--primary);">Payment Number</div>
                        <div style="font-size: 18px; font-weight: 700;">0765098865</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-weight: 600; color: var(--primary);">Response Time</div>
                        <div style="font-size: 18px; font-weight: 700;">5-10 minutes</div>
                    </div>
                </div>
            </div>
            
            <div class="copyright">
                <p>&copy; 2024 RevisionVault. All rights reserved.</p>
                <p style="margin-top: 5px; font-size: 12px;">Made with ‚ù§Ô∏è for Kenyan university students</p>
            </div>
        </footer>
    </div>

    <script>
        // ================= CONFIGURATION =================
        const CONFIG = {
            // YOUR CREDENTIALS
            yourPhoneNumber: '254765098865',      // 0765098865 in 254 format
            yourWhatsAppNumber: '254765098865',   // Same for WhatsApp
            yourTelegramLink: 'https://t.me/+QlZ_LCrZoB5kZjNk',
            
            // FREE DATABASE (Using JSONBin as free alternative to Google Sheets)
            databaseUrl: 'https://api.jsonbin.io/v3/b/65abf9c2266cfc3fde8e5a3a/latest',
            databaseKey: '$2a$10$YourKeyHere', // You'll get this from jsonbin.io
            
            // SUBSCRIPTION SETTINGS
            subscriptionDays: 180,  // 6 months
            price: 50,              // Ksh 50
            currency: 'Ksh',
            
            // APP SETTINGS
            appName: 'RevisionVault',
            testMode: false
        };

        // ================= INITIALIZE APP =================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ RevisionVault Initializing...');
            initApp();
        });

        function initApp() {
            // Display payment number
            document.getElementById('mpesaDisplay').textContent = '0765098865';
            
            // Setup WhatsApp links
            const whatsappLinks = document.querySelectorAll('#whatsappLink, #footerWhatsapp');
            whatsappLinks.forEach(link => {
                link.href = `https://wa.me/${CONFIG.yourWhatsAppNumber}`;
            });
            
            // Setup phone input formatting
            const phoneInput = document.getElementById('userPhone');
            phoneInput.addEventListener('input', formatPhoneInput);
            
            // Setup search functionality
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', searchDocuments);
            
            // Auto-uppercase transaction code
            const txnInput = document.getElementById('txnCode');
            txnInput.addEventListener('input', function(e) {
                e.target.value = e.target.value.toUpperCase();
            });
            
            // Load documents
            loadDocuments();
            
            // Check existing subscription
            checkExistingSubscription();
            
            console.log('‚úÖ App Ready!');
            showWelcomeMessage();
        }

        // ================= FORMATTING FUNCTIONS =================
        function formatPhoneForDisplay(phone) {
            if (phone.startsWith('254')) {
                return '0' + phone.substring(3, 6) + ' ' + phone.substring(6, 9) + ' ' + phone.substring(9);
            }
            return phone;
        }

        function formatPhoneForAPI(phone) {
            let cleaned = phone.replace(/\s+/g, '');
            if (cleaned.startsWith('0')) {
                return '254' + cleaned.substring(1);
            }
            return cleaned;
        }

        function formatPhoneInput(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length > 0) {
                if (value.length <= 3) {
                    value = value;
                } else if (value.length <= 6) {
                    value = value.substring(0, 3) + ' ' + value.substring(3);
                } else {
                    value = value.substring(0, 3) + ' ' + value.substring(3, 6) + ' ' + value.substring(6, 9);
                }
            }
            e.target.value = value;
        }

        // ================= PAYMENT VERIFICATION =================
        async function verifyPayment() {
            const phone = document.getElementById('userPhone').value.trim();
            const txnCode = document.getElementById('txnCode').value.trim().toUpperCase();

            // Validation
            if (!phone || phone.replace(/\s/g, '').length < 9) {
                showStatus('Please enter a valid Kenyan phone number', 'error');
                return;
            }

            if (!txnCode || txnCode.length < 8) {
                showStatus('Please enter a valid transaction code (8-10 characters)', 'error');
                return;
            }

            const formattedPhone = formatPhoneForAPI(phone);

            // Create WhatsApp message
            const whatsappMessage = 
                `üìö *REVISIONVAULT PAYMENT VERIFICATION*\n\n` +
                `‚Ä¢ Transaction Code: *${txnCode}*\n` +
                `‚Ä¢ Phone Number: *${phone}*\n` +
                `‚Ä¢ Amount: *Ksh 50*\n` +
                `‚Ä¢ Date: *${new Date().toLocaleDateString('en-GB')}*\n` +
                `‚Ä¢ Paid to: *0765098865*\n\n` +
                `Please activate my subscription. Thank you!`;

            showStatus('‚úÖ Opening WhatsApp with verification details...', 'success');

            setTimeout(() => {
                const encodedMessage = encodeURIComponent(whatsappMessage);
                const whatsappURL = `https://wa.me/${CONFIG.yourWhatsAppNumber}?text=${encodedMessage}`;
                window.open(whatsappURL, '_blank');
                
                // Save pending verification
                localStorage.setItem('pending_verification', JSON.stringify({
                    phone: formattedPhone,
                    txnCode: txnCode,
                    timestamp: new Date().toISOString()
                }));
            }, 1500);

            // Clear form
            document.getElementById('userPhone').value = '';
            document.getElementById('txnCode').value = '';
        }

        function testPayment() {
            // Generate test data
            const testPhone = '2547' + Math.floor(Math.random() * 100000000).toString().padStart(8, '0');
            const testTxn = 'TEST' + Math.floor(Math.random() * 10000).toString().padStart(4, '0');
            
            document.getElementById('userPhone').value = formatPhoneForDisplay(testPhone);
            document.getElementById('txnCode').value = testTxn;
            
            showStatus('üß™ Demo mode activated. Click "Submit for Verification" to test WhatsApp flow.', 'success');
        }

        // ================= DOCUMENTS MANAGEMENT =================
        const DOCUMENTS = [
            {
                id: 1,
                title: "Calculus II - Complete Past Papers 2020-2023",
                course: "Mathematics",
                university: "University of Nairobi",
                year: 2023,
                size: "2.4 MB",
                pages: 45,
                downloadUrl: "https://t.me/+QlZ_LCrZoB5kZjNk/1",
                tags: ["mathematics", "calculus", "past-papers"]
            },
            {
                id: 2,
                title: "Data Structures & Algorithms - Comprehensive Notes",
                course: "Computer Science",
                university: "Kenyatta University",
                year: 2022,
                size: "3.1 MB",
                pages: 68,
                downloadUrl: "https://t.me/+QlZ_LCrZoB5kZjNk/2",
                tags: ["cs", "algorithms", "notes"]
            },
            {
                id: 3,
                title: "Microeconomics - Theory & Practice Questions",
                course: "Economics",
                university: "Moi University",
                year: 2021,
                size: "1.8 MB",
                pages: 32,
                downloadUrl: "https://t.me/+QlZ_LCrZoB5kZjNk/3",
                tags: ["economics", "business", "theory"]
            },
            {
                id: 4,
                title: "Organic Chemistry - Revision Notes",
                course: "Chemistry",
                university: "JKUAT",
                year: 2023,
                size: "2.2 MB",
                pages: 42,
                downloadUrl: "https://t.me/+QlZ_LCrZoB5kZjNk/4",
                tags: ["chemistry", "science", "notes"]
            },
            {
                id: 5,
                title: "Financial Accounting - Past Papers with Solutions",
                course: "Commerce",
                university: "Strathmore University",
                year: 2022,
                size: "4.5 MB",
                pages: 78,
                downloadUrl: "https://t.me/+QlZ_LCrZoB5kZjNk/5",
                tags: ["accounting", "commerce", "past-papers"]
            },
            {
                id: 6,
                title: "Physics I - Practical Lab Manual",
                course: "Physics",
                university: "Egerton University",
                year: 2023,
                size: "3.7 MB",
                pages: 56,
                downloadUrl: "https://t.me/+QlZ_LCrZoB5kZjNk/6",
                tags: ["physics", "science", "lab"]
            }
        ];

        function loadDocuments() {
            const container = document.getElementById('documentsList');
            const hasAccess = localStorage.getItem('revisionvault_subscription') ? true : false;
            
            let html = '';
            
            DOCUMENTS.forEach(doc => {
                html += `
                    <div class="document-card">
                        <div class="doc-icon">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <div class="doc-content">
                            <h3 class="doc-title">${doc.title}</h3>
                            <div class="doc-meta">
                                <span class="meta-tag">${doc.course}</span>
                                <span class="meta-tag">${doc.university}</span>
                                <span class="meta-tag">${doc.year}</span>
                            </div>
                            <p style="color: var(--gray); margin-bottom: 15px;">
                                <i class="fas fa-file"></i> ${doc.pages} pages ‚Ä¢ 
                                <i class="fas fa-database"></i> ${doc.size}
                            </p>
                            
                            ${hasAccess ? 
                                `<a href="${doc.downloadUrl}" class="download-btn" target="_blank">
                                    <i class="fas fa-download"></i> Download PDF
                                </a>` :
                                `<div style="background: #fee2e2; color: #991b1b; padding: 10px; border-radius: 8px; text-align: center;">
                                    <i class="fas fa-lock"></i> Subscribe to unlock (Ksh 50)
                                </div>`
                            }
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function searchDocuments() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const cards = document.querySelectorAll('.document-card');
            
            cards.forEach(card => {
                const title = card.querySelector('.doc-title').textContent.toLowerCase();
                const meta = card.querySelector('.doc-meta').textContent.toLowerCase();
                
                if (title.includes(searchTerm) || meta.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // ================= USER MANAGEMENT =================
        function checkExistingSubscription() {
            const subscription = localStorage.getItem('revisionvault_subscription');
            
            if (subscription) {
                const data = JSON.parse(subscription);
                const expiry = new Date(data.expires);
                const today = new Date();
                
                if (expiry > today) {
                    // Active subscription
                    showUserPanel(data);
                } else {
                    localStorage.removeItem('revisionvault_subscription');
                }
            }
        }

        function showUserPanel(data) {
            const expiry = new Date(data.expires);
            const daysLeft = Math.ceil((expiry - new Date()) / (1000 * 60 * 60 * 24));
            
            // Update user panel
            document.getElementById('userPanel').style.display = 'block';
            document.getElementById('userName').textContent = data.name || 'Premium User';
            document.getElementById('daysLeft').textContent = daysLeft;
            document.getElementById('expiryDate').textContent = expiry.toLocaleDateString('en-GB');
            document.getElementById('documentsCount').textContent = DOCUMENTS.length;
            
            // Update status indicator
            document.getElementById('userStatus').innerHTML = `
                <span style="display: flex; align-items: center; gap: 8px; background: #d1fae5; color: #065f46; padding: 8px 16px; border-radius: 50px;">
                    <i class="fas fa-crown"></i>
                    <span>Active (${daysLeft} days)</span>
                </span>
            `;
        }

        function logout() {
            localStorage.removeItem('revisionvault_subscription');
            document.getElementById('userPanel').style.display = 'none';
            document.getElementById('userStatus').innerHTML = '';
            showStatus('Logged out successfully.', 'success');
            loadDocuments(); // Reload to show locked documents
        }

        function requestNotes() {
            const course = prompt('Which course notes do you need? (e.g., "Calculus II", "Data Structures"):');
            
            if (course) {
                const message = 
                    `üìö *REVISIONVAULT NOTE REQUEST*\n\n` +
                    `‚Ä¢ Course Needed: *${course}*\n` +
                    `‚Ä¢ Date: *${new Date().toLocaleDateString('en-GB')}*\n\n` +
                    `Please upload notes for this course.`;
                
                showStatus('üìù Opening WhatsApp for your request...', 'success');
                
                setTimeout(() => {
                    const encodedMessage = encodeURIComponent(message);
                    const whatsappURL = `https://wa.me/${CONFIG.yourWhatsAppNumber}?text=${encodedMessage}`;
                    window.open(whatsappURL, '_blank');
                }, 1000);
            }
        }

        // ================= UI FUNCTIONS =================
        function showStatus(message, type) {
            const statusDiv = document.getElementById('statusMessage');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
            statusDiv.style.display = 'block';
            
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 5000);
        }

        function showWelcomeMessage() {
            console.log(`
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë           REVISIONVAULT READY TO LAUNCH          ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë ‚úÖ M-Pesa: 0765098865                            ‚ïë
‚ïë ‚úÖ WhatsApp: 0765098865                          ‚ïë
‚ïë ‚úÖ Telegram: t.me/+QlZ_LCrZoB5kZjNk              ‚ïë
‚ïë ‚úÖ GitHub: walterzauko23/Revisionvault           ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë üöÄ Next Steps:                                   ‚ïë
‚ïë 1. Save this code as index.html                  ‚ïë
‚ïë 2. Upload to GitHub                              ‚ïë
‚ïë 3. Enable GitHub Pages                           ‚ïë
‚ïë 4. Add real PDFs to Telegram                     ‚ïë
‚ïë 5. Share with users!                             ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
            `);
        }

        // Keyboard shortcuts for testing
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.shiftKey && e.key === 'T') {
                testPayment();
            }
            if (e.ctrlKey && e.shiftKey && e.key === 'L') {
                // Auto-login for testing
                const testUser = {
                    phone: '254712345678',
                    name: 'Test User',
                    expires: new Date(new Date().setDate(new Date().getDate() + 180)).toISOString()
                };
                localStorage.setItem('revisionvault_subscription', JSON.stringify(testUser));
                showUserPanel(testUser);
                showStatus('Test user logged in successfully.', 'success');
            }
        });
    </script>
</body>
</html>